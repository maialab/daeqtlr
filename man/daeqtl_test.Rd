% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/daeqtl_test.R
\name{daeqtl_test}
\alias{daeqtl_test}
\title{DAEQTL mapping approach}
\usage{
daeqtl_test(
  ae_hom,
  ae_het,
  dae_threshold = log2(1.5),
  min_n_hom = 2L,
  min_n_het = 2L
)
}
\arguments{
\item{ae_hom}{Numeric vector of AE ratios of the DAE SNP. Each element of the
vector refers to a sample that is homozygous (\code{hom}) for the candidate
SNP.}

\item{ae_het}{Numeric vector of AE ratios of the DAE SNP. Each element of the
vector refers to a sample that is heterozygous (\code{het}) for the
candidate SNP.}

\item{dae_threshold}{An allelic expression (AE) threshold (in log-scale). A
sample showing an absolute AE greater than \code{dae_threshold} is considered
"technically" \emph{differential allelic expressed}, meaning that the
imbalance observed is not below the limit of detection. Adjustment made to
this parameter should depend on the experimental assay sensitivity.}

\item{min_n_hom}{Minimum number of samples in the homozygous group to be
considered eligible for statistical testing.}

\item{min_n_het}{Minimum number of samples in the heterozygous group to be
considered eligible for statistical testing.}
}
\value{
A data frame of two columns:
\describe{
\item{pvalue}{The p-value associated with the statistical test, if performed; otherwise, \code{NA}.}
\item{case}{One of the four possible cases depicted in the figure above.
The identified case depends on the number of samples for each group and on
the pattern of the allelic expression (AE) ratios of the DAE SNP:
\describe{
\item{\code{1}}{\strong{Case 1}: the number of samples for which the candidate SNP is
heterozygous and DAE SNP expression is available is below the minimum
eligibility criterion \code{min_n_het}.}
\item{\code{2}}{\strong{Case 2}: (i) the number of samples for which the candidate SNP is
homozygous is below \code{min_n_hom}, and also, (ii) the values of the DAE
SNP AE ratios are not all either below or above the \code{dae_threshold}.}
\item{\code{3}}{\strong{Case 3}: the number of samples for which the candidate SNP is
homozygous is below \code{min_n_hom}, however, the values of the DAE
SNP AE ratios are all either below or above the \code{dae_threshold}. This
case is followed by a one-sample Wilcox test whose null hypothesis is that
the AE ratios are zero.}
\item{\code{4}}{\strong{Case 4}: when both a minimum number of heterozygous and
homozygous samples for the candidate SNP are available, then a Wilcox test
is applied that compares the two groups. The AE ratios are first
transformed to absolute values. This is because we want to test departure
from zero in either direction. The null hypothesis is that absolute AE
ratios for the heterozygous group is less than or equal to the homozygous
group.}
}
}
}
}
\description{
This function implements daeqtlr's default mapping approach, i.e. the mapping
of SNPs associated with DAE. The mapping approach here implemented takes into
consideration the pattern of the allelic expression (AE) ratios' distribution
displayed at each DAE SNP (depicted below), as this is dependent on the
linkage disequilibrium between the DAE SNP and the candidate SNP.

\if{html}{\figure{mapping_approach.svg}{Mapping approach}}
\if{latex}{\figure{mapping_approach.png}{options: width=0.5in}}
}
\examples{
#
# Case 1
#
# The number of heterozygous samples (n = 1) does not meet the minimum
# required (default is `min_n_het` = 2). Hence, no statistical test is
# applied, the `pvalue` is `NA` and `case` is `1`.
#
daeqtl_test(ae_hom = c(0.3, 0.1, 1.3 , 1.5, 0.4),
            ae_het = 0.3)

# Now with a higher `min_n_het`.
daeqtl_test(ae_hom = c(0.3, 0.1, 1.3, 1.5, 0.4),
            ae_het = c(0.3, 2.1, 3.2),
            min_n_het = 4L)

#
# Case 2
#
# The number of homozygous samples does not meet the minimum requirement
# (default is `min_n_hom` = 2) and also the AE ratios are not either all
# above or all below the DAE threshold (`dae_threshold`).
#
daeqtl_test(ae_hom = numeric(),
            ae_het = c(0.3, 0.1, 1.3 , 1.5, 0.4, 0.59, 0.67, 0.89, 1.35))

#
# Case 3
#
# The number of homozygous samples does not meet the minimum requirement
# (default is `min_n_hom` = 2) but the AE ratios are either all above or all
# below the DAE threshold (default is `dae_threshold = log2(1.5)`).
#
daeqtl_test(ae_hom = numeric(),
            ae_het = c(2.8, 3.1, 1.3 , 1.5, 2.3, 0.59, 0.67, 0.89, 1.35))

# Same as previous example, but with the minimum possible value of
# `dae_threshold` set, i.e. `0`.
#
daeqtl_test(ae_hom = numeric(),
            ae_het = c(2.8, 3.1, 1.3 , 1.5, 2.3, 0.59, 0.67, 0.89, 1.35),
            dae_threshold = 0)

#
# Case 4
#
# Both the number of homozygous and heterozygous samples are equal or
# above the minima defined by `min_n_hom` and `min_n_het`. Hence, a
# two-sample Wilcox test is applied to test the null hypothesis that the
# absolute AE ratios for the heterozygous group is less than or equal to
# those of the homozygous group.
#
# Example: Both groups show imbalance above zero, i.e. show preference for
# the same allele. However, the imbalance magnitude of the heterozygous group
# is clearly below that of the homozygous group, resulting in a
# non-significant p-value.
daeqtl_test(ae_hom = c(1.9, 2.1, 2 , 1.5, 1.4), ae_het = c(0.3, 0.6, 0.7))

# Example: the heterozygous group clearly shows greater imbalance (greater
# departure from zero) than the homozygous group, resulting in a significant
# p-value.
daeqtl_test(
  ae_hom = c(0.1, 0.3, 0.2 , 0.21, 0.15),
  ae_het = c(0.6, 0.8, 1.2, -1.5, -3, -2.5, -1, 2, 2.7)
)

# Example: the exact reverse of the previous example
daeqtl_test(
  ae_hom = c(0.6, 0.8, 1.2, -1.5, -3, -2.5, -1, 2, 2.7),
  ae_het = c(0.1, 0.3, 0.2 , 0.21, 0.15)
)


}
